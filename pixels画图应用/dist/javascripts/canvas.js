define(["exports"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),n={x:10,y:10,size:20,color:"#3498DB",bgColor:"#ffffff",mode:"draw",parent:document.body},s=function(){function t(i){e(this,t),Object.assign(this,n,i),this.mouseDownFn=this.mouseDownFn.bind(this),this.mouseMoveFn=this.mouseMoveFn.bind(this),this.mouseEndFn=this.mouseEndFn.bind(this),this.init()}return i(t,[{key:"init",value:function(){this.createContainer(),this.bindEvent(),this.library?this.setBlockStyle():this.library={}}},{key:"empty",value:function(){for(var t in this.library)this.blocks[t].style.backgroundColor="transparent",delete this.library[t]}},{key:"reset",value:function(){this.library={},this.removeEvent(),this.parent.removeChild(this.container),this.createContainer(),this.bindEvent()}},{key:"setBlockStyle",value:function(){for(var t in this.library)this.blocks[t].style.backgroundColor=this.library[t].color}},{key:"createContainer",value:function(){this.container=document.createElement("DIV"),this.container.className="container",this.container.style.cssText="width: "+this.size*this.x+"px; height: "+this.size*this.y+"px;";for(var t="",e=0,i=this.x*this.y;e<i;e++)t+='<div style="width: '+this.size+"px; height: "+this.size+'px;" data-num="'+e+'" class="block"></div>';this.container.innerHTML=t,this.parent.appendChild(this.container),this.blocks=this.container.children}},{key:"bindEvent",value:function(){this.container.addEventListener("mousedown",this.mouseDownFn,!1),this.container.addEventListener("mousemove",this.mouseMoveFn,!1),document.body.addEventListener("mouseup",this.mouseEndFn,!1),document.body.addEventListener("mouseleave",this.mouseEndFn,!1)}},{key:"removeEvent",value:function(){this.container.removeEventListener("mousedown",this.mouseDownFn,!1),this.container.removeEventListener("mousemove",this.mouseMoveFn,!1),document.body.removeEventListener("mouseup",this.mouseEndFn,!1),document.body.removeEventListener("mouseleave",this.mouseEndFn,!1)}},{key:"mouseDownFn",value:function(t){var e=this.getIndex(t.target);e&&this.setSomeBlock(e),this.flag=!0}},{key:"mouseMoveFn",value:function(t){if(this.flag){var e=this.getIndex(t.target);e&&this.setSomeBlock(e)}}},{key:"mouseEndFn",value:function(){this.flag=!1}},{key:"getIndex",value:function(t){return!!t.classList.contains("block")&&t.getAttribute("data-num")}},{key:"setSomeBlock",value:function(t){var e=this.library[t];"draw"===this.mode?e?e.color!==this.color&&(this.library[t].color=this.color,this.blocks[t].style.backgroundColor=this.color):(this.library[t]={x:t%this.x,y:~~(t/this.x),color:this.color},this.blocks[t].style.backgroundColor=this.color):e&&(delete this.library[t],this.blocks[t].style.backgroundColor="transparent")}},{key:"setImage",value:function(t){var e=this;this.canvas=document.createElement("canvas"),this.canvas.width=this.x*this.size,this.canvas.height=this.y*this.size,this.cxt=this.canvas.getContext("2d"),this.img=new Image,this.img.onload=function(){e.img.width=e.x*e.size,e.img.height=e.y*e.size,e.cxt.drawImage(e.img,0,0,e.img.width,e.img.height),e.getParticle()},this.img.src=t}},{key:"getParticle",value:function(){for(var t=this.getImageData(),e=parseInt(this.img.width/this.x),i=parseInt(this.img.height/this.y),n=0,s=0;s<this.x;s++)for(var o=0;o<this.y;o++)if(n=o*i*this.img.width+s*e,t[n]&&0!==t[n][3]){var r={x:s,y:o,color:"rgba("+t[n].join(",")+")"},h=o*this.x+s;this.library[h]=r,this.blocks[h].style.backgroundColor="rgba("+t[n].join(",")+")"}}},{key:"getImageData",value:function(){var t=this.cxt.getImageData(0,0,this.img.width,this.img.height),e=t.data,i=t.data.length,n=[];t.width!==this.img.width&&(this.img.width=t.width),t.height!==this.img.height&&(this.img.height=t.height);for(var s=0;s<i/4;s++)n.push([e[4*s],e[4*s+1],e[4*s+2],e[4*s+3]]);return n}}]),t}();t["default"]=s});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbnZhcy5qcyJdLCJuYW1lcyI6WyJkZWZpbmUiLCJleHBvcnRzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9kZWZhdWx0IiwieCIsInkiLCJzaXplIiwiY29sb3IiLCJiZ0NvbG9yIiwibW9kZSIsInBhcmVudCIsImRvY3VtZW50IiwiYm9keSIsIkNhbnZhcyIsIm9wdGlvbiIsInRoaXMiLCJhc3NpZ24iLCJtb3VzZURvd25GbiIsImJpbmQiLCJtb3VzZU1vdmVGbiIsIm1vdXNlRW5kRm4iLCJpbml0IiwiY3JlYXRlQ29udGFpbmVyIiwiYmluZEV2ZW50IiwibGlicmFyeSIsInNldEJsb2NrU3R5bGUiLCJibG9ja3MiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsInJlbW92ZUV2ZW50IiwicmVtb3ZlQ2hpbGQiLCJjb250YWluZXIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiY3NzVGV4dCIsImRpdnMiLCJjb3VudCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiY2hpbGRyZW4iLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJpbmRleCIsImdldEluZGV4Iiwic2V0U29tZUJsb2NrIiwiZmxhZyIsImVsZW0iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImdldEF0dHJpYnV0ZSIsIm9iaiIsInNyYyIsIl90aGlzIiwiY2FudmFzIiwid2lkdGgiLCJoZWlnaHQiLCJjeHQiLCJnZXRDb250ZXh0IiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJkcmF3SW1hZ2UiLCJnZXRQYXJ0aWNsZSIsImltYWdlRGF0YSIsImdldEltYWdlRGF0YSIsInNfd2lkdGgiLCJwYXJzZUludCIsInNfaGVpZ2h0IiwicG9zIiwiaiIsInBhcnRpY2xlIiwiam9pbiIsImRhdGEiLCJsZW4iLCJhcnIiLCJwdXNoIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBUSxXQUFZLFNBQVVDLEdBQTlCLFlBT0MsU0FBU0MsR0FBZ0JDLEVBQVVDLEdBQ2xDLEtBQU1ELFlBQW9CQyxJQUN6QixLQUFNLElBQUlDLFdBQVUscUNBTnRCQyxPQUFPQyxlQUFlTixFQUFTLGNBQzlCTyxPQUFPLEdBU1IsSUFBSUMsR0FBZSxXQUNsQixRQUFTQyxHQUFpQkMsRUFBUUMsR0FDakMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FDdEMsR0FBSUUsR0FBYUgsRUFBTUMsRUFDdkJFLEdBQVdDLFdBQWFELEVBQVdDLGFBQWMsRUFDakRELEVBQVdFLGNBQWUsRUFDdEIsU0FBV0YsS0FBWUEsRUFBV0csVUFBVyxHQUNqRFosT0FBT0MsZUFBZUksRUFBUUksRUFBV0ksSUFBS0osSUFJaEQsTUFBTyxVQUFVWCxFQUFhZ0IsRUFBWUMsR0FHekMsTUFGSUQsSUFBWVYsRUFBaUJOLEVBQVlrQixVQUFXRixHQUNwREMsR0FBYVgsRUFBaUJOLEVBQWFpQixHQUN4Q2pCLE1BekJObUIsR0FDSEMsRUFBRyxHQUNIQyxFQUFHLEdBQ0hDLEtBQU0sR0FDTkMsTUFBTyxVQUNQQyxRQUFTLFVBQ1RDLEtBQU0sT0FDTkMsT0FBUUMsU0FBU0MsTUFHR0MsRUE2QlAsV0E1QmIsUUFBQUEsR0FBWUMsR0FBT2hDLEVBQUFpQyxLQUFBRixHQUNsQjNCLE9BQU84QixPQUFPRCxLQUFNWixFQUFVVyxHQUM5QkMsS0FBS0UsWUFBY0YsS0FBS0UsWUFBWUMsS0FBS0gsTUFDekNBLEtBQUtJLFlBQWNKLEtBQUtJLFlBQVlELEtBQUtILE1BQ3pDQSxLQUFLSyxX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aEMsR0FBQUEsV0EvTm9CZ0MiLCJmaWxlIjoiY2FudmFzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxubGV0IF9kZWZhdWx0ID0ge1xyXG5cdHg6IDEwLFxyXG5cdHk6IDEwLFxyXG5cdHNpemU6IDIwLFxyXG5cdGNvbG9yOiAnIzM0OThEQicsXHJcblx0YmdDb2xvcjogJyNmZmZmZmYnLFxyXG5cdG1vZGU6ICdkcmF3JyxcclxuXHRwYXJlbnQ6IGRvY3VtZW50LmJvZHlcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FudmFzIHtcclxuXHRjb25zdHJ1Y3RvcihvcHRpb24pe1xyXG5cdFx0T2JqZWN0LmFzc2lnbih0aGlzLCBfZGVmYXVsdCwgb3B0aW9uKVxyXG5cdFx0dGhpcy5tb3VzZURvd25GbiA9IHRoaXMubW91c2VEb3duRm4uYmluZCh0aGlzKVxyXG5cdFx0dGhpcy5tb3VzZU1vdmVGbiA9IHRoaXMubW91c2VNb3ZlRm4uYmluZCh0aGlzKVxyXG5cdFx0dGhpcy5tb3VzZUVuZEZuID0gdGhpcy5tb3VzZUVuZEZuLmJpbmQodGhpcylcclxuXHJcblx0XHR0aGlzLmluaXQoKVxyXG5cdH1cclxuXHRpbml0KCkge1xyXG5cdFx0dGhpcy5jcmVhdGVDb250YWluZXIoKVxyXG5cdFx0dGhpcy5iaW5kRXZlbnQoKVxyXG5cdFx0aWYgKHRoaXMubGlicmFyeSkge1xyXG5cdFx0XHR0aGlzLnNldEJsb2NrU3R5bGUoKVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMubGlicmFyeSA9IHt9XHJcblx0XHR9XHJcblx0fVxyXG5cdGVtcHR5KCkge1xyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLmxpYnJhcnkpIHtcclxuXHRcdFx0dGhpcy5ibG9ja3NbaV0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3RyYW5zcGFyZW50J1xyXG5cdFx0XHRkZWxldGUgdGhpcy5saWJyYXJ5W2ldXHJcblx0XHR9XHJcblx0fVxyXG5cdHJlc2V0KCkge1xyXG5cdFx0dGhpcy5saWJyYXJ5ID0ge31cclxuXHRcdHRoaXMucmVtb3ZlRXZlbnQoKVxyXG5cdFx0dGhpcy5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5jb250YWluZXIpXHJcblx0XHR0aGlzLmNyZWF0ZUNvbnRhaW5lcigpXHJcblx0XHR0aGlzLmJpbmRFdmVudCgpXHJcblx0fVxyXG5cdHNldEJsb2NrU3R5bGUoKSB7XHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMubGlicmFyeSkge1xyXG5cdFx0XHR0aGlzLmJsb2Nrc1tpXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLmxpYnJhcnlbaV0uY29sb3JcclxuXHRcdH1cclxuXHR9XHJcblx0Y3JlYXRlQ29udGFpbmVyKCkge1xyXG5cdFx0dGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKVxyXG5cdFx0dGhpcy5jb250YWluZXIuY2xhc3NOYW1lID0gJ2NvbnRhaW5lcidcclxuXHRcdHRoaXMuY29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgd2lkdGg6ICR7dGhpcy5zaXplICogdGhpcy54fXB4OyBoZWlnaHQ6ICR7dGhpcy5zaXplICogdGhpcy55fXB4O2BcclxuXHRcdGxldCBkaXZzID0gJydcclxuXHRcdGZvciAobGV0IGkgPSAwLCBjb3VudCA9IHRoaXMueCAqIHRoaXMueTsgaSA8IGNvdW50OyBpKyspIHtcclxuXHRcdFx0ZGl2cyArPSBgPGRpdiBzdHlsZT1cIndpZHRoOiAke3RoaXMuc2l6ZX1weDsgaGVpZ2h0OiAke3RoaXMuc2l6ZX1weDtcIiBkYXRhLW51bT1cIiR7aX1cIiBjbGFzcz1cImJsb2NrXCI+PC9kaXY+YFxyXG5cdFx0fVxyXG5cdFx0dGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gZGl2c1xyXG5cdFx0dGhpcy5wYXJlbnQuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXIpXHJcblx0XHR0aGlzLmJsb2NrcyA9IHRoaXMuY29udGFpbmVyLmNoaWxkcmVuXHJcblx0fVxyXG5cdGJpbmRFdmVudCgpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMubW91c2VEb3duRm4sIGZhbHNlKVxyXG5cdFx0dGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3VzZU1vdmVGbiwgZmFsc2UpXHJcblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm1vdXNlRW5kRm4sIGZhbHNlKVxyXG5cdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5tb3VzZUVuZEZuLCBmYWxzZSlcclxuXHR9XHJcblx0cmVtb3ZlRXZlbnQoKSB7XHJcblx0XHR0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm1vdXNlRG93bkZuLCBmYWxzZSlcclxuXHRcdHRoaXMuY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW91c2VNb3ZlRm4sIGZhbHNlKVxyXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5tb3VzZUVuZEZuLCBmYWxzZSlcclxuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMubW91c2VFbmRGbiwgZmFsc2UpXHJcblx0fVxyXG5cdG1vdXNlRG93bkZuKGUpIHtcclxuXHRcdGxldCBpbmRleCA9IHRoaXMuZ2V0SW5kZXgoZS50YXJnZXQpXHJcblx0XHRpbmRleCAmJiB0aGlzLnNldFNvbWVCbG9jayhpbmRleClcclxuXHRcdHRoaXMuZmxhZyA9IHRydWVcclxuXHR9XHJcblx0bW91c2VNb3ZlRm4oZSkge1xyXG5cdFx0aWYgKHRoaXMuZmxhZykge1xyXG5cdFx0XHRsZXQgaW5kZXggPSB0aGlzLmdldEluZGV4KGUudGFyZ2V0KVxyXG5cdFx0XHRpbmRleCAmJiB0aGlzLnNldFNvbWVCbG9jayhpbmRleClcclxuXHRcdH1cclxuXHR9XHJcblx0bW91c2VFbmRGbigpIHtcclxuXHRcdHRoaXMuZmxhZyA9IGZhbHNlXHJcblx0fVxyXG5cdGdldEluZGV4KGVsZW0pIHtcclxuXHRcdGlmICghZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2Jsb2NrJykpXHJcblx0XHRcdHJldHVybiBmYWxzZVxyXG5cclxuXHRcdHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1udW0nKVxyXG5cdH1cclxuXHRzZXRTb21lQmxvY2soaW5kZXgpIHtcclxuXHRcdGxldCBvYmogPSB0aGlzLmxpYnJhcnlbaW5kZXhdXHJcblx0XHRpZiAodGhpcy5tb2RlID09PSAnZHJhdycpIHtcclxuXHRcdFx0aWYgKG9iaikge1xyXG5cdFx0XHRcdGlmIChvYmouY29sb3IgIT09IHRoaXMuY29sb3IpIHtcclxuXHRcdFx0XHRcdHRoaXMubGlicmFyeVtpbmRleF0uY29sb3IgPSB0aGlzLmNvbG9yXHJcblx0XHRcdFx0XHR0aGlzLmJsb2Nrc1tpbmRleF0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5jb2xvclxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0aGlzLmxpYnJhcnlbaW5kZXhdID0ge1xyXG5cdFx0XHRcdFx0eDogaW5kZXggJSB0aGlzLngsXHJcblx0XHRcdFx0XHR5OiB+fihpbmRleCAvIHRoaXMueCksXHJcblx0XHRcdFx0XHRjb2xvcjogdGhpcy5jb2xvclxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLmJsb2Nrc1tpbmRleF0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5jb2xvclxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChvYmopIHtcclxuXHRcdFx0ZGVsZXRlIHRoaXMubGlicmFyeVtpbmRleF1cclxuXHRcdFx0dGhpcy5ibG9ja3NbaW5kZXhdLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd0cmFuc3BhcmVudCdcclxuXHRcdH1cclxuXHR9XHJcblx0c2V0SW1hZ2Uoc3JjKSB7XHJcblx0XHR0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG5cdFx0dGhpcy5jYW52YXMud2lkdGggPSB0aGlzLnggKiB0aGlzLnNpemVcclxuXHRcdHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMueSAqIHRoaXMuc2l6ZVxyXG5cdFx0dGhpcy5jeHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXHJcblx0XHR0aGlzLmltZyA9IG5ldyBJbWFnZSgpXHJcblx0XHR0aGlzLmltZy5vbmxvYWQgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMuaW1nLndpZHRoID0gdGhpcy54ICogdGhpcy5zaXplXHJcblx0XHRcdHRoaXMuaW1nLmhlaWdodCA9IHRoaXMueSAqIHRoaXMuc2l6ZVxyXG5cdFx0XHR0aGlzLmN4dC5kcmF3SW1hZ2UodGhpcy5pbWcsIDAsIDAsIHRoaXMuaW1nLndpZHRoLCB0aGlzLmltZy5oZWlnaHQpXHJcblx0XHRcdHRoaXMuZ2V0UGFydGljbGUoKVxyXG5cdFx0fVxyXG5cdFx0dGhpcy5pbWcuc3JjID0gc3JjXHJcblx0fVxyXG5cdGdldFBhcnRpY2xlKCkge1xyXG5cdFx0bGV0IGltYWdlRGF0YSA9IHRoaXMuZ2V0SW1hZ2VEYXRhKClcclxuXHRcdGxldCBzX3dpZHRoID0gcGFyc2VJbnQodGhpcy5pbWcud2lkdGggLyB0aGlzLngpXHJcblx0XHRsZXQgc19oZWlnaHQgPSBwYXJzZUludCh0aGlzLmltZy5oZWlnaHQgLyB0aGlzLnkpXHJcblx0XHRsZXQgcG9zID0gMFxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLng7IGkrKykge1xyXG5cdFx0XHRmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMueTsgaisrKSB7XHJcblx0XHRcdFx0cG9zID0gKGogKiBzX2hlaWdodCkgKiAodGhpcy5pbWcud2lkdGgpICsgKGkgKiBzX3dpZHRoKVxyXG5cdFx0XHRcdGlmIChpbWFnZURhdGFbcG9zXSAmJiBpbWFnZURhdGFbcG9zXVszXSAhPT0gMCkge1xyXG5cdFx0XHRcdFx0LypcclxuXHRcdFx0XHRcdOiHquWumuS5iei/h+a7pOaWueazlVxyXG5cdFx0XHRcdFx0aWYgKGltYWdlRGF0YVtwb3NdWzBdID09PSAyNTUgJiYgaW1hZ2VEYXRhW3Bvc11bMV0gPT09IDI1NSAmJiBpbWFnZURhdGFbcG9zXVsyXSA9PT0gMjU1KSB7XHJcblx0XHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ki9cclxuXHRcdFx0XHRcdGxldCBwYXJ0aWNsZSA9IHtcclxuXHRcdFx0XHRcdFx0eDogaSxcclxuXHRcdFx0XHRcdFx0eTogaixcclxuXHRcdFx0XHRcdFx0Y29sb3I6IGByZ2JhKCR7aW1hZ2VEYXRhW3Bvc10uam9pbignLCcpfSlgXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRsZXQgaW5kZXggPSBqICogdGhpcy54ICsgaVxyXG5cdFx0XHRcdFx0dGhpcy5saWJyYXJ5W2luZGV4XSA9IHBhcnRpY2xlXHJcblx0XHRcdFx0XHR0aGlzLmJsb2Nrc1tpbmRleF0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYmEoJHtpbWFnZURhdGFbcG9zXS5qb2luKCcsJyl9KWBcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0Z2V0SW1hZ2VEYXRhKCkge1xyXG5cdFx0bGV0IGltYWdlRGF0YSA9IHRoaXMuY3h0LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmltZy53aWR0aCwgdGhpcy5pbWcuaGVpZ2h0KVxyXG5cdFx0bGV0IGRhdGEgPSBpbWFnZURhdGEuZGF0YVxyXG5cdFx0bGV0IGxlbiA9IGltYWdlRGF0YS5kYXRhLmxlbmd0aFxyXG5cdFx0bGV0IGFyciA9IFtdXHJcblx0XHQvL+i/t+S5i+S4jeebuOetie+8n1xyXG5cdFx0aWYgKGltYWdlRGF0YS53aWR0aCAhPT0gdGhpcy5pbWcud2lkdGgpIHRoaXMuaW1nLndpZHRoID0gaW1hZ2VEYXRhLndpZHRoXHJcblx0XHRpZiAoaW1hZ2VEYXRhLmhlaWdodCAhPT0gdGhpcy5pbWcuaGVpZ2h0KSB0aGlzLmltZy5oZWlnaHQgPSBpbWFnZURhdGEuaGVpZ2h0XHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxlbiAvIDQ7IGkrKykge1xyXG5cdFx0XHRhcnIucHVzaChbZGF0YVtpICogNF0sIGRhdGFbaSAqIDQgKyAxXSwgZGF0YVtpICogNCArIDJdLCBkYXRhW2kgKiA0ICsgM11dKVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGFyclxyXG5cdH1cclxufTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
